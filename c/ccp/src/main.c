#include <linux/limits.h>
#include <stdio.h>
#include <stdlib.h>
#include <string.h>
#include <unistd.h>

#include "configs.h"

const char *dog_ascii =
"                                      &&&,%/&&&&&&                              \n"
"                             %&&&%/#,,,,,,,,,,,%&&&%                            \n"
"                      #&%########,,,,,**,,**.,,*,,,,,,,,.&%                     \n"
"                   (&############.,,,,,,,,,,,,,,,,,,,,,,,,,,,%                  \n"
"                 &&###############,,,,,,,,,,,,,,,,,,,,,,,,,,,,.&                \n"
"               #&#################,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,&               \n"
"              &####################,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,&             \n"
"            /&#####################,,,,,,,,,,,,,,,,,,,,,,,,,,,#,,,,&            \n"
"           &#######################,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,/*          \n"
"         &######%##################.,,,,,,,,,,,,,,,,,,,,,,,,,,,,*,,,,,&         \n"
"       &######%%########&&&&&######,,,,,,,,,,,,,,,,,&&&&&,,,,,,,#**,,,,.%,      \n"
"    &#######%%%########&&  &&&#####,,,,,,,,,,,,,,,*&&  &&&,,,,,,,&***,,,,,,&&   \n"
"#%%%%##%%%%%%%#########&&&&&&&####,,,,,,,,,,,,,,,,,&&&&&&&,,,,,,,,#*******,****#\n"
" &%%%%%%%%%%%&#################/,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,***********&.\n"
"    &%%%%%%%%%##############(,,,,,,,.&#####&.,,,,,,,,,,,,,,,,,,,,,,&******%&&   \n"
"            %##########,,,,,,,,,,,,,&#######&,,,,,,,,,,,,,,,,,,,,,,*            \n"
"            &,,,,,,,,,,,,,,,,,,,,,,,,,&&%&&,,,,,,,,,,,,,,,,,,,,,,,,.            \n"
"            &,,,,,,,,,,,,,,,,,,,&,,,,,,,&,,,,,,,&,,,,,,,,,,,,,,,,,,,            \n"
"            .*,,,,,,,,,,,,,,,,,,&..,,,,.&.,,,,,%%,,,,,,,,,,,,,,,,,,&            \n"
"             &.,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,*             \n"
"               &,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,.&              \n"
"                  &&.,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,.&,                 \n"
"                         *&#,,,,,,,,,,,,,,,,,,,,,,,,,&&*&                       \n"
"                        &*******************************&                       \n"
"                        &,,,,************************,,,.,                      \n"
"                       .*,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,&                      \n"
"           &&.,.@&*    &,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,&     &&,,,#&          \n"
"         &,,,,,,,,,,(  &,,,,,,,,**,,,,,,,,,,,,,,,,,,,,,,,&  &,,,,,,,,,,&        \n"
"        %,,,,,,,,,,,,,.&,,&,,,,,,,,**,**,**,,,,,,,,,,,&,,,&,,,,,,,,,,,,,,#      \n"
"       @,,,,,,,,,,,,,,,,,,&,,,,,,,,&,,,,,,,,*.,,,,,,,,&,,,&,,,,,,,,,,,,,,,      \n"
"       .,,,,,,,,,,,,,,(,,,%.,,,,,,,&,,,,,,,,,&,,,,,,,(,,,,&,,,,,,,,,,,,,,,%     \n"
"       &,,,,,,,,,,,,,,&,,,,#,,,,,,,#,,,,,,,,,&,,,,,,,&,,,,,,,,,,,,,,,,,,,*      \n"
"        &/,,,,,,,,,,,,(,,,*&,,,,,,&*,,,,,,,,,&,,,,,,,&*,,,,/,,,,,,,,,,,,&       \n"
"          &&,,,,,,,,,,,,,,*%,,,,,,&**,,,,,,**/*,,,,,./*,,,,,,,,,,,,,,,&         \n"
"             &.,,,,,,,,,,,**&,,,,,&***********&,,,,,&**,,,,,,,,,,,,&&    /&     \n"
"                &.,/,,,,,,**&,,,,,&***********&,,,,,(**,,,,,,,/.&&%%%%%&%       \n"
"                  /,,,,,,,*#,,,,,,,%*********&,,,,,,/**,,,,,,,,%                \n"
"                           (///(#&&&         &#*,*/(#&                          ";

int main(int argc, char *argv[])
{
    if (argc != 2) {
        fprintf(stderr, "usage: %s <project_name>\n", argv[0]);
        exit(1);
    }
    set_project_name(argv[1]);
    char project_dir[PATH_MAX];
    if (getcwd(project_dir, sizeof(project_dir)) == NULL) {
        fprintf(stderr, "Cannot access current directory.");
        exit(1);
    }
    strcat(project_dir, "/");
    strcat(project_dir, argv[1]);

    create_project_dir(project_dir);

    create_config(project_dir, MAKEFILE);
    create_config(project_dir, CLANG_FORMAT);
    create_config(project_dir, CLANG_D);
    create_config(project_dir, CLANG_TIDY);

    printf(
        "\033[32mProject %s created.\n"
        "%s\033[0m\n",
        argv[1], dog_ascii
    );

    return 0;
}
